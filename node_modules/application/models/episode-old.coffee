Show = require 'application/models/show'
youtube = require('youtube-get')(process.env.YOUTUBE_API_KEY)

fetchEpisodesFromSinglePlaylistId = (playlistId, callback) ->

  apiParams =
    part: 'id,snippet,status,contentDetails'
    id: playlistId

  youtube 'playlists', apiParams, (data) ->
    console.log data

fetchEpisodesFromPlaylistIds = (playlistIds, callback) ->

  apiParams =
    part: 'id,snippet,status,contentDetails'
    id: playlistIds.join(',')

  youtube 'playlists', apiParams, (data) ->
    console.log data



findAll = (callback) ->
  await Show.findAll defer(shows)
  episodes = []
  await
    for show, i in shows
      if show.playlists.length is 1
        fetchEpisodesFromPlaylistId show.playlists[0], defer(episodes[i])
      else
        fetchEpisodesFromPlaylistIds show.playlists, defer(episodes[i])


findByName = (name, callback) ->

findByPk = (id, callback) ->

module.exports =
  findAll: findAll
  findByName: findByName
  findByPk: findByPk
